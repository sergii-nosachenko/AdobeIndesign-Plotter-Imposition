# Інструкція з користування

## Зміст

- [Перший запуск](#перший-запуск)
- [Головне вікно](#головне-вікно)

## Перший запуск

Після успішного встановлення скрипта (цей процес описано [тут](../readme-uk.md)), можна перейти до налаштувань.
Перший запуск супроводжується попереджувальним вікном про відсутність файлу з налаштуваннями `preferences.json`.

![Script Alert](images/settings-not-found-alert-en.png?raw=true)

- `Yes` (`Так`) - скрипт створить порожній файл для збереження налаштувань і відкриється [Головне вікно](#головне-вікно).
- `No` (`Ні`) - скрипт завершиться.

Наявність файлу `preferences.json` є обов'язковою. Якщо у вас є вже збережені налаштування, ви можете скопювати цей файл до теки, що вказана у діалоговому вікні (це тека `Script Panel`, в якій знаходиться скрипт).

## Головне вікно

По замовчанню головне мова головного вікна буде відповідати мові інтерфейсу Adobe InDesign. У випадку, якщо скрипт не підтримує цю мову, буде відображено англійську версію.
На сьогодні скрипт підтримує українську та англійську мови.

![Main Window Initial](images/main-window-initial-uk.png?raw=true)

Головний екран складається з трьох основних секцій та нижньої панелі:

### Секція А: **Вхідні файли**

Дана секція дозволяє вибрати вхідні файл(и) для розкладки.

<details>
    <summary>Елементи 1-2</summary>
    
**(1)** Кнопка `Обрати` запускає діалогове вікно вибору файлів. Вибрані файли замінять всі вже наявні в списку (2). 

**(2)** Список вибраних файлів з розбивкою по сторінкам.

</details>

---

### Секція B: **Налаштування розкладки**

Дана секція керує параметрами обробки файлів під час розкладки.

<details>
    <summary>Елементи 3-5</summary>

**(3)** Випадаючий список `Метод розкладки` має три пункти:

- **Кожен вид на окремий лист**: кожна сторінка в розкладці міститиме лише макети одного виду. Якщо чекбокс (4) активний, то багатосторінкові файли будуть збережені багатосторінковими, як в оригіналі.

- **Вмістити всі види на 1+ лист**: кожен документ міститиме всі файли з однаковими параметрами фігур (розмір, скругління кутів, роздвижка), що повторюватимуться від 1 разу та більше, дозаповнюючи лист повністю. Кількість листів буде збільшено на стільки, щоб розмістити всі види макетів. Кількість повторень одного макету розраховується автоматично.

- **Вручну**: вручну сформований список копій для кожної сторінки або групи сторінок. При виборі цього пункту з'явиться текстове поле (5).

**(4)** Чекбокс `Залишити багатосторінковість`: Якщо чекбокс активний, то багатосторінкові файли будуть збережені багатосторінковими, як в оригіналі. Інакше кожна сторінка в списку файлів буде збережена як окремий файл.

**(5)** Текстове поле `Список копій кожної сторінки`:

Потрібно вказати кількість копій кожної сторінки через кому (послідовність - згідно списку (2)). Можна задати кількість сторінок підряд у форматі мультиплікатор `x` кількість копій.

Кількість копій буде автоматично збільшено, щоб дозаповнити порожні місця в документі.

```
Задача:
Вибрано 4 файли або сторінки. Необхідна кількість копій:
стор. 1 - 15 копій, 
стор. 2 - 10 копій,
стор. 3 - 10 копій,
стор. 4 - 8 копій

Приклад заповлення поля Вручну:
15,2x10,8

Якщо на листі розміщується 8 макетів, то буде сформовано документ з наступною кількістю копій:
17, 11, 11 та 9 копій = 48 шт
6 сторінок в документі

```

Якщо потрібно дозаповнити лише конкретні сторінки потрібно поставити знак `+` після кількості копій.

```
Задача:
Вибрано 4 файли або сторінки. Необхідна кількість копій:
стор. 1 - 15 копій, 
стор. 2 - Точно 10 копій,
стор. 3 - 10 копій,
стор. 4 - Точно 8 копій

Приклад заповлення поля Вручну:
15+,10,10+,8

Якщо на листі розміщується 8 макетів, то буде сформовано документ з наступною кількістю копій:
18, 10, 12 та 8 копій = 48 шт
6 сторінок в документі

```    

</details>

---

### Секція C: **Налаштування експорту**

Дана секція дозволяє налаштувати необхідні параметри плотерів, способк розкладки та збереження результатів.

<details>
    <summary>Елементи 6-11</summary>

**(6)** Кнопка `Тека для збереження результатів`. Дає можливість вибрати шлях для збереження результатів розкладки. Обраний шлях відображатиметься в полі (7). Обов'язково для роботи скрипта.

**(7)** Поле `Назва теки`. Відображає шлях до вибраної теки.

**(8)** Текстове поле `Формат назви файлу`. Залежно від обраного в пункті (3) методу розкладки:

- Якщо обрано `Кожен вид на окремий лист` дозволяє задати **префікс назви файлу**, який буде додано перед оригінальною назвою файлу.

    ```
    Приклад:
    Назва оригінального файлу: MySticker_logo.pdf
    Префікс: #11-2345
    Обрані налаштування розкладки:
    Форма - коло діаметром 40 мм,
    роздвижка - 1 мм,
    кількість на листі - 35 штук,
    аліас формату листа - SRA3,
    аліас плотера - MP

    Збережена назва розкладки:
    #11-2345_MySticker_logo_D=40(1)mm_MP_SRA3.pdf
    ```

- Якщо обрано `Вмістити всі види на 1+ лист` або `Вручну` потребує введення **повної назви файлу**, яяка буде використана для назви файлу. Є можливість використати плейсхолдер %names%, замість якого буде вставлено назву або назви файлів (якщо їх декілька).

**(9)** Поле `Спосіб розкладки`. Відображає обраний спосіб розкладки.

**(10)** Кнопка Налаштувань плотерів та способу розкладки.

**(11)** Випадаючий список `Налаштування для PDF-експорту`. Дозволяє вибрати один з попередньо налаштованих профілів для експорту розкладки у формат PDF. Цей пункт використовує дані, збережені через налаштування експорту Adobe Indesign (або Adobe Acrobat Professional).   

</details>

---

**(12)** Випадаючий список вибору мови інтерфейсу. Зміна мови потребує ручного перезапуску скрипта.

**(13)** Кнопка `Відміна`. Завершує роботу скрипта.

**(14)** Кнопка `Розкласти`. Активується, коли встановлено всі необхідні для розкладки налаштування. Запускає роботу скрипта.  